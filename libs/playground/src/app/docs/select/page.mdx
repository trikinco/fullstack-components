import { Example } from '@/src/components/Example'
import UseSelect from './UseSelect'
import { URL_DEPLOYMENT } from '@/src/utils/constants'
import { routes } from '@/src/utils/routes'

export const metadata = {
  title: 'Select - Smart AI-Powered Dropdowns And Lists',
  description:
    'A smart dropdown component that creates, labels and sorts all its own options.',
  alternates: {
    canonical: `${new URL(
      routes.select,
      URL_DEPLOYMENT || URL_BASE
    )}`,
  },
}

# Select

A smart dropdown component that creates, labels and sorts all its own options.

```jsx
import { handleSelectRequest } from '@trikinco/fullstack-components'
import { getSelect } from '@trikinco/fullstack-components'
import { Select } from '@trikinco/fullstack-components'
import { useSelect } from '@trikinco/fullstack-components/client'
```

## `Select` Server Component

```jsx
<Select
  prompt="Time zone in GMT"
  purpose="Selecting a time zone based on major city"
  context="Sydney, Australia should be selected"
  count="all zones"
/>
```

## `useSelect` hook

`useSelect` is a utility hook that allows for full access to Select generation data.
Useful for generating lists or when creating custom dropdown components.

```jsx
'use client'

import { useSelect } from '@trikinco/fullstack-components/client'

export default () => {
  const { isLoading, isError, data } = useSelect({
    prompt:
      'The nearest countries to Australia. Include a flag emoji in the label.',
    count: 10,
  })

  if (isLoading) {
    return 'Loading "The 10 nearest countries to Australia"'
  }

  if (isError) {
    return 'Could not load "The 10 nearest countries to Australia"'
  }

  return (
    <>
      <p className="font-bold">{data?.label}</p>
      <ul>
        {data?.content?.map((item) => (
          <li key={item.value}>{item.label}</li>
        ))}
      </ul>
    </>
  )
}
```

<Example>
  <UseSelect />
</Example>

## `getSelect` utility

`getSelect` is a built-in fetcher with all the same options as `useSelect`, but it works on the server. Handy for making your own custom Server Components.

```jsx title="Server Component"
import { getSelect } from '@trikinco/fullstack-components'

export default async function Page() {
  const { label, content } = await getSelect({
    prompt:
      'The nearest countries to Australia. Add a flag emoji in the label.',
    count: 10,
  })

  return (
    <>
      <p id="label" role="label">
        {label}
      </p>
      <div
        role="listbox"
        tabindex="0"
        id="dropdown"
        aria-labelledby="label"
        aria-activedescendant="dropdown-1"
        // ...other required attributes
      >
        {content?.map(({ label, value }) => (
          <div role="option" id={`dropdown-${value}`} key={value}>
            {label}
          </div>
        ))}
      </div>
    </>
  )
}
```

## Setup

Add `select: handleSelectRequest()` to the [API handler route](/docs/get-started/#setup).

```ts title="app/api/fsutils/[...fscomponents]/route.ts"
import {
  handleFSComponents,
  handleSelectRequest,
  type FSCOptions,
} from '@trikinco/fullstack-components'

const fscOptions: FSCOptions = {
  select: handleSelectRequest({
    openAiApiKey: process.env.OPENAI_API_KEY || '',
  }),
  // Additional options and handlers...
}

const fscHandler = handleFSComponents(fscOptions)

export { fscHandler as GET, fscHandler as POST }
```

2. Import and use the `Select` component, or the `useSelect` hook from `/client`.

```jsx
import { Select } from '@trikinco/fullstack-components'
import { useSelect } from '@trikinco/fullstack-components/client'
```
